<?php
session_start();

// ❌ REMOVIDO: logout automático
// unset($_SESSION['user']);

// Inicializa array de eventos se não existir ou se não for array
if (!isset($_SESSION['eventos']) || !is_array($_SESSION['eventos'])) {
    $_SESSION['eventos'] = [];
}
?>
<!doctype html>
<html lang="pt-PT">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>HumaniCare</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- Cabeçalho unificado -->
<header>
  <nav>
    <div class="nav-links">
      <a href="#sobre">Sobre</a>
      <a href="#projeto">Projetos</a>
      <a href="#doacoes">Doações</a>
      <a href="#envolva">Envolva-se</a>
      <a href="#criar-evento">Criar Evento</a>
      <a href="#eventosProjetos">Eventos</a>
      <a href="login.php">Login</a>
    </div>
  </nav>
</header>

<main class="container">

  <!-- Logo principal -->
  <h1 class="logo">HUMANI <span>CARE</span></h1>

  <!-- Banner principal -->
  <section class="banner">
    <div class="banner-text">
      <p>
        <strong>Junte-se ao meu movimento de voluntariado ambiental!</strong><br>
        Participe em atividades práticas de preservação, reflorestamento e educação ambiental. 
        Com pequenas ações, pode fazer uma grande diferença, ajudando o planeta hoje 
        e garantindo um futuro sustentável para as próximas gerações.
      </p>
    </div>
    <div class="banner-img">
      <img src="https://media.iatiseguros.com/wp-content/uploads/sites/6/2020/01/20115833/tipos-voluntariado.jpg" alt="Voluntariado Img Principal">
    </div>
  </section>

  <!-- Secção de cartões -->
  <section class="grid">
    <div class="card" id="sobre">
      <h3>Sobre</h3>
      <p>Sou uma pessoa dedicada ao voluntariado e à promoção de práticas sustentáveis.</p>
      <a href="#" class="link-mais">Mais</a>
    </div>
    <div class="card" id="projeto">
      <h3>Projeto</h3>
      <p>Desenvolvo este projeto de voluntariado com a intenção de ajudar quem mais necessita.</p>
      <a href="#" class="link-mais">Mais</a>
    </div>
    <div class="card" id="doacoes">
      <h3>Doações</h3>
      <p>A sua doação ajuda-me a continuar o meu trabalho. Cada doação ajuda este website a melhorar.</p>
      <a href="#" class="link-mais">Mais</a>
    </div>
    <div class="card" id="envolva">
      <h3>Envolva-se</h3>
      <p>Participe em atividades, crie eventos que ajudem a comunidade e o planeta.</p>
      <a href="#" class="link-mais">Mais</a>
    </div>
  </section>

  <!-- Secção Criar Evento -->
  <section id="criar-evento">
    <h3>Login Necessário</h3>
    <p>Para criar um evento, por favor <a href="login.php">faça login</a>.</p>
  </section>

  <!-- Secção Eventos Criados -->
  <section id="eventosProjetos">
    <h3 class="titulo-eventos">Eventos Criados</h3>

    <?php if (!empty($_SESSION['eventos'])): ?>
      <?php foreach ($_SESSION['eventos'] as $evento): ?>
        <div class="evento-card">
          <h4><?php echo htmlspecialchars($evento['nome']); ?></h4>

          <?php if (!empty($evento['imagem'])): ?>
            <img src="<?php echo htmlspecialchars($evento['imagem']); ?>" alt="<?php echo htmlspecialchars($evento['nome']); ?>" class="evento-img">
          <?php endif; ?>

          <p>
            <strong>Data:</strong> <?php echo htmlspecialchars($evento['data']); ?>
            <strong>Local:</strong> <?php echo htmlspecialchars($evento['local']); ?>
          </p>

          <p><strong>Descrição:</strong> <?php echo htmlspecialchars($evento['descricao']); ?></p>

          <button class="participar-btn">Participar</button>
          <p>Pessoas a participar: <span class="contador">0</span></p>
        </div>
      <?php endforeach; ?>
    <?php endif; ?>

  </section>

</main>

<footer>
  © 2025 por David B. Criado em PHP.
</footer>

<!-- Script Participar -->
<script>
document.querySelectorAll('.participar-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const contador = btn.nextElementSibling.querySelector('.contador');
    contador.textContent = parseInt(contador.textContent) + 1;
  });
});
</script>

</body>
</html>
